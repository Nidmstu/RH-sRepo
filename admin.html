<!DOCTYPE html>
<html lang="ru">
<head>
  <link type="image/png" sizes="16x16" rel="icon" href="https://i.postimg.cc/gJf9MgWR/icons8-32.png">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Администрирование курсов</title>
  <!-- Подключаем marked.js для парсинга Markdown -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <!-- Подключаем Font Awesome для иконок -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
  <style>
    /* Основные стили */
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f9f9f9;
    }

    /* Стили для модального окна импорта уроков */
    .admin-modal {
      display: block;
      position: fixed;
      z-index: 9999;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      overflow: auto;
    }

    .admin-modal-content {
      background-color: #fefefe;
      margin: 10% auto;
      padding: 0;
      border: 1px solid #888;
      border-radius: 5px;
      width: 80%;
      max-width: 700px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      max-height: 80vh;
      display: flex;
      flex-direction: column;
    }

    .admin-modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background-color: #f5f5f5;
      border-bottom: 1px solid #ddd;
    }

    .admin-modal-header h3 {
      margin: 0;
    }

    .admin-modal-close {
      color: #aaa;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
    }

    .admin-modal-close:hover {
      color: #333;
    }

    .admin-modal-body {
      padding: 20px;
      overflow-y: auto;
      flex: 1;
    }

    .admin-modal-footer {
      padding: 15px;
      background-color: #f5f5f5;
      border-top: 1px solid #ddd;
      text-align: right;
    }

    .admin-header {
      background-color: #2c3e50;
      color: white;
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      width: 100%;
      box-sizing: border-box;
      flex-wrap: wrap;
    }

    .admin-header h1 {
      margin: 0;
      font-size: 1.5rem;
      flex-shrink: 1;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .admin-header-actions {
      display: flex;
      gap: 10px;
      flex-shrink: 0;
    }

    .admin-body {
      display: flex;
      flex-direction: row;
      width: 100%;
      height: calc(100vh - 60px);
      overflow: hidden;
    }

    .admin-sidebar {
      width: 50%;
      background-color: #fff;
      border-right: 1px solid #ddd;
      padding: 15px;
      height: 100%;
      overflow-y: auto;
      flex: 0 0 50%;
      box-sizing: border-box;
    }

    .admin-sidebar-section {
      margin-bottom: 20px;
    }

    .admin-sidebar-section h3 {
      margin-top: 0;
      padding-bottom: 8px;
      border-bottom: 1px solid #eee;
    }

    .admin-content {
      width: 50%;
      padding: 20px;
      background-color: #f9f9f9;
      height: 100%;
      overflow-y: auto;
      flex: 0 0 50%;
      box-sizing: border-box;
    }

    .admin-panel-section {
      background-color: #fff;
      border-radius: 5px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      padding: 20px;
      margin-bottom: 20px;
      overflow-x: auto;
      width: 100%;
      box-sizing: border-box;
    }

    .admin-section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }

    .admin-section-header h2, 
    .admin-section-header h3 {
      margin: 0;
      word-break: break-word;
    }

    .admin-section-actions {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .admin-section-divider {
      height: 1px;
      background-color: #eee;
      margin: 20px 0;
      width: 100%;
    }

    .admin-btn {
      padding: 8px 15px;
      background-color: #f0f0f0;
      border: 1px solid #ddd;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.9rem;
      color: #333;
      transition: all 0.2s;
      text-align: center;
      min-height: 36px;
    }

    .admin-btn:hover {
      background-color: #e0e0e0;
    }

    .admin-btn-primary {
      background-color: #3498db;
      border-color: #2980b9;
      color: white;
    }

    .admin-btn-primary:hover {
      background-color: #2980b9;
    }

    .admin-btn-success {
      background-color: #2ecc71;
      border-color: #27ae60;
      color: white;
    }

    .admin-btn-success:hover {
      background-color: #27ae60;
    }

    .admin-btn-danger {
      background-color: #e74c3c;
      border-color: #c0392b;
      color: white;
    }

    .admin-btn-danger:hover {
      background-color: #c0392b;
    }

    .admin-btn-sm {
      padding: 4px 10px;
      font-size: 0.8rem;
      min-height: 30px;
    }

    .admin-btn-block {
      display: block;
      width: 100%;
      text-align: center;
      margin-top: 10px;
    }

    .admin-list {
      border: 1px solid #eee;
      border-radius: 4px;
      overflow: hidden;
      width: 100%;
    }

    .admin-list:empty::after {
      content: "Нет элементов";
      display: block;
      padding: 15px;
      text-align: center;
      color: #999;
      font-style: italic;
    }

    .admin-list-item {
      padding: 12px 15px;
      border-bottom: 1px solid #eee;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: #fff;
      transition: background-color 0.2s;
      flex-wrap: wrap;
    }

    .admin-list-item:last-child {
      border-bottom: none;
    }

    .admin-list-item:hover {
      background-color: #f5f5f5;
    }

    .admin-list-item-info {
      flex: 1;
      min-width: 0;
      word-break: break-word;
    }

    .admin-list-item-title {
      font-weight: 500;
      margin-bottom: 3px;
    }

    .admin-list-item-subtitle {
      font-size: 0.8rem;
      color: #777;
    }

    .admin-list-item-source {
      font-size: 0.75rem;
      color: #006699;
      margin-top: 2px;
    }

    .admin-list-item-actions {
      display: flex;
      gap: 5px;
      flex-wrap: wrap;
    }

    .nav-link {
      display: inline-block;
      padding: 8px 15px;
      color: white;
      text-decoration: none;
      margin-right: 15px;
      border-radius: 4px;
    }

    .nav-link:hover {
      background-color: rgba(255, 255, 255, 0.1);
      text-decoration: none;
    }

    .hidden {
      display: none !important;
    }

    /* Стили для форм */
    .admin-form {
      width: 100%;
    }

    .admin-form-row {
      display: flex;
      gap: 15px;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }

    .admin-form-group {
      margin-bottom: 15px;
      flex: 1;
      min-width: 250px;
    }

    .admin-form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
    }

    .admin-input, 
    .admin-select, 
    .admin-textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 16px;
      box-sizing: border-box;
    }

    .admin-textarea {
      min-height: 120px;
      resize: vertical;
    }

    /* Стили для табов */
    .admin-tabs {
      margin-top: 20px;
      width: 100%;
    }

    .admin-tab-header {
      display: flex;
      border-bottom: 1px solid #ddd;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }

    .admin-tab-btn {
      padding: 10px 15px;
      background: none;
      border: none;
      cursor: pointer;
      font-weight: 500;
      opacity: 0.6;
      text-align: center;
    }

    .admin-tab-btn.active {
      opacity: 1;
      border-bottom: 2px solid #3498db;
    }

    .admin-tab-pane {
      display: block;
    }

    .admin-tab-pane.hidden {
      display: none !important;
    }

    .admin-tab-pane {
      display: block;
    }

    .admin-tab-pane {
      display: block;
    }

    .admin-tab-btn {
      cursor: pointer;
    }

    .admin-tab-btn.active {
      background-color: #f0f0f0;
      border-bottom: 2px solid #3498db;
    }

    /* Аккордеон для мобильных устройств */
    .admin-accordion {
      margin-bottom: 15px;
      border: 1px solid #ddd;
      border-radius: 4px;
      overflow: hidden;
    }

    .admin-accordion-header {
      padding: 12px 15px;
      background-color: #f5f5f5;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .admin-accordion-header h3 {
      margin: 0;
      font-size: 1rem;
    }

    .admin-accordion-content {
      padding: 15px;
      background-color: #fff;
      border-top: 1px solid #eee;
    }

    /* Мобильная навигация */
    .admin-mobile-nav-toggle {
      display: none;
      background-color: #3498db;
      color: white;
      border: none;
      width: 100%;
      padding: 12px;
      margin-bottom: 15px;
      text-align: center;
      font-weight: bold;
      cursor: pointer;
      border-radius: 4px;
    }

    /* Адаптивные стили для планшетов */
    @media (max-width: 1024px) and (min-width: 481px) {
      .admin-body {
        flex-direction: row;
        display: flex;
        flex-wrap: nowrap;
        width: 100%;
        height: calc(100vh - 60px);
        overflow: hidden;
      }

      .admin-mobile-nav-toggle {
        display: none;
      }

      .admin-sidebar {
        width: 50% !important;
        min-width: 50% !important;
        max-width: 50% !important;
        height: 100%;
        padding: 15px;
        border-right: 1px solid #ddd;
        display: flex;
        flex-direction: column;
        flex: 0 0 50% !important;
        box-sizing: border-box;
        overflow-y: auto;
        overflow-x: hidden;
      }

      .admin-content {
        width: 50% !important;
        min-width: 50% !important;
        max-width: 50% !important;
        flex: 0 0 50% !important;
        box-sizing: border-box;
        overflow-y: auto;
        height: 100%;
        padding: 15px;
      }
    }

    /* Стили для альбомной ориентации на планшетах */
    @media (max-width: 1024px) and (min-width: 481px) and (orientation: landscape) {
      .admin-body {
        flex-direction: row;
      }

      .admin-sidebar {
        width: 50% !important;
        flex: 0 0 50% !important;
      }

      .admin-content {
        width: 50% !important;
        flex: 0 0 50% !important;
      }
    }

    /* Стили для портретной ориентации на планшетах */
    @media (max-width: 1024px) and (min-width: 481px) and (orientation: portrait) {
      .admin-body {
        flex-direction: row;
      }

      .admin-sidebar {
        width: 50% !important;
        flex: 0 0 50% !important;
      }

      .admin-content {
        width: 50% !important;
        flex: 0 0 50% !important;
      }
    }

    /* Адаптивные стили для мобильных устройств */
    @media (max-width: 480px) {
      .admin-body {
        flex-direction: column;
      }

      .admin-mobile-nav-toggle {
        display: block;
      }

      .admin-sidebar {
        width: 100%;
        min-height: auto;
        padding: 15px;
        border-right: none;
        border-bottom: 1px solid #ddd;
        display: flex;
        flex-direction: column;
      }

      .admin-content {
        padding: 15px;
        width: 100%;
      }

      .admin-header {
        flex-direction: column;
        align-items: flex-start;
        padding: 15px;
      }

      .admin-header-actions {
        margin-top: 15px;
        width: 100%;
        flex-direction: column;
      }

      .admin-header h1 {
        font-size: 1.3rem;
        margin-bottom: 10px;
        width: 100%;
      }

      .nav-link {
        margin: 5px 0;
        width: 100%;
        text-align: center;
        padding: 12px;
      }

      .admin-btn {
        width: 100%;
        margin: 5px 0;
        padding: 12px 10px;
        font-size: 16px;
        height: auto;
      }

      .admin-section-header {
        flex-direction: column;
        align-items: flex-start;
      }

      .admin-section-actions {
        width: 100%;
        margin-top: 10px;
      }

      .admin-panel-section {
        padding: 15px;
        overflow-x: auto;
      }

      .admin-list-item {
        flex-direction: column;
        align-items: flex-start;
      }

      .admin-list-item-info {
        width: 100%;
        margin-bottom: 10px;
      }

      .admin-list-item-actions {
        margin-top: 10px;
        width: 100%;
        justify-content: space-between;
      }

      .admin-list-item-actions .admin-btn {
        flex: 1;
      }

      .admin-tab-header {
        flex-direction: column;
      }

      .admin-tab-btn {
        width: 100%;
        margin: 2px 0;
        padding: 12px;
        border-bottom: 1px solid #eee;
      }

      .admin-tab-btn.active {
        border-bottom: 2px solid #3498db;
      }

      .admin-form-row {
        flex-direction: column;
        gap: 10px;
      }

      .admin-form-group {
        width: 100%;
        min-width: 100%;
      }

      /* Фиксим отображение списка курсов на мобильных */
      #admin-courses-list {
        display: block !important;
        width: 100% !important;
        margin-bottom: 15px;
      }

      /* Улучшенная видимость боковой панели и элементов списка на мобильных */
      .admin-sidebar {
        box-sizing: border-box;
        padding: 10px;
        width: 100% !important;
      }

      .admin-list-item {
        padding: 15px 10px;
      }

      .admin-list-item-actions {
        flex-wrap: wrap;
        justify-content: space-between;
      }

      .admin-list-item-actions .admin-btn {
        margin: 5px 0;
        padding: 10px;
        flex: 1;
        min-width: 40%;
      }
    }

    /* Стили для очень маленьких экранов */
    @media (max-width: 480px) {
      body {
        font-size: 15px;
      }

      .admin-header h1 {
        font-size: 1.2rem;
      }

      .admin-btn {
        font-size: 15px;
        padding: 10px;
      }

      .admin-content {
        padding: 10px;
      }

      .admin-panel-section {
        padding: 12px;
        margin-bottom: 15px;
      }

      .admin-sidebar {
        padding: 10px;
      }

      .admin-list-item {
        padding: 10px;
      }

      .admin-input, 
      .admin-select, 
      .admin-textarea {
        font-size: 16px;
        padding: 12px 10px;
      }

      .admin-form-group label {
        font-size: 15px;
      }

      /* Увеличиваем размер всех интерактивных элементов для лучшего тапа */
      .admin-btn-sm {
        padding: 8px;
        font-size: 14px;
        min-height: 36px;
      }

      /* Убираем лишние отступы в формах */
      .admin-form-group {
        margin-bottom: 12px;
      }
    }

    /* Стили для кнопок справки */
    .admin-help-btn {
      background: none;
      border: none;
      padding: 0;
      margin-left: 5px;
      color: #3498db;
      cursor: pointer;
      font-size: 0.9rem;
      vertical-align: middle;
      transition: color 0.2s ease;
    }

    .admin-help-btn:hover {
      color: #2980b9;
    }

    /* Стили для модальных окон */
    .admin-help-modal {
      display: none;
      position: fixed;
      z-index: 10000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0, 0, 0, 0.5);
    }

    .admin-help-modal-content {
      background-color: #fefefe;
      margin: 15% auto;
      padding: 20px;
      border-radius: 5px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      max-width: 500px;
      position: relative;
    }

    .admin-help-modal-title {
      margin-top: 0;
      margin-bottom: 10px;
      color: #3498db;
    }

    .admin-help-modal-close {
      color: #aaa;
      position: absolute;
      top: 10px;
      right: 15px;
      font-size: 24px;
      font-weight: bold;
      cursor: pointer;
    }

    .admin-help-modal-close:hover {
      color: #333;
    }
    .json-example pre {
      background-color: #f0f0f0;
      padding: 10px;
      border-radius: 4px;
      overflow-x: auto;
    }
  </style>
</head>
<body>
  <div class="admin-header">
    <h1>Управление курсами</h1>
    <div class="admin-header-actions">
      <a href="index.html" class="nav-link">
        <i class="fas fa-graduation-cap"></i> К обучению
      </a>
      <button id="admin-export-all" class="admin-btn">
        <i class="fas fa-download"></i> Экспорт данных
      </button>
      <button id="admin-webhook-export" class="admin-btn admin-btn-success">
        <i class="fas fa-cloud-upload-alt"></i> Отправить на вебхук
      </button>
    </div>
  </div>

  <div class="admin-body">
    <button id="toggle-sidebar" class="admin-mobile-nav-toggle">
      <i class="fas fa-bars"></i> Показать/скрыть меню курсов
    </button>
    <div class="admin-sidebar">
      <div class="admin-sidebar-section">
        <h3>Курсы</h3>
        <div id="admin-courses-list" class="admin-list"></div>
        <button id="admin-add-course" class="admin-btn admin-btn-success admin-btn-block">
          <i class="fas fa-plus"></i> Добавить курс
        </button>
      </div>
    </div>

    <div class="admin-content">
      <!-- Начальный экран -->
      <div id="admin-welcome" class="admin-panel-section">
        <div class="admin-welcome-content" style="text-align: center; padding: 50px 0;">
          <h2>Добро пожаловать в панель управления</h2>
          <p>Выберите курс в боковом меню или создайте новый</p>
        </div>
      </div>

      <!-- Редактирование курса -->
      <div id="admin-course-editor" class="admin-panel-section hidden">
        <div class="admin-section-header">
          <h2>Редактирование курса: <span id="admin-course-title">Название курса</span></h2>
          <div class="admin-section-actions">
            <button id="admin-save-course" class="admin-btn admin-btn-primary">Сохранить</button>
            <button id="admin-export-course" class="admin-btn">Экспорт</button>
            <button id="admin-import-course" class="admin-btn">Импорт</button>
          </div>
        </div>

        <div class="admin-course-form">
          <div class="admin-form-group">
            <label for="admin-course-id">ID курса:</label>
            <input type="text" id="admin-course-id" class="admin-input">
          </div>
          <div class="admin-form-group">
            <label for="admin-course-title-input">Название курса:</label>
            <input type="text" id="admin-course-title-input" class="admin-input">
          </div>
          <div class="admin-form-group">
            <label for="admin-course-redirect">URL перенаправления (опционально):</label>
            <input type="text" id="admin-course-redirect" class="admin-input" placeholder="Оставьте пустым, если перенаправление не требуется">
          </div>
        </div>

        <div class="admin-section-divider"></div>

        <div class="admin-tabs">
          <div class="admin-tab-header">
            <button class="admin-tab-btn active" data-tab="days">Дни обучения</button>
            <button class="admin-tab-btn" data-tab="special-lessons">Специальные уроки</button>
            <button class="admin-tab-btn" data-tab="webhooks">Настройки вебхуков</button>
          </div>

          <div class="admin-tab-content">
            <!-- Дни обучения -->
            <div id="admin-tab-days" class="admin-tab-pane" style="display: block;">
              <div class="admin-section-header">
                <h3>Дни обучения</h3>
                <button id="admin-add-day" class="admin-btn admin-btn-sm admin-btn-success">
                  <i class="fas fa-plus"></i> Добавить день
                </button>
              </div>
              <div id="admin-days-list" class="admin-list"></div>
            </div>

            <!-- Специальные уроки -->
            <div id="admin-tab-special-lessons" class="admin-tab-pane hidden">
              <div class="admin-section-header">
                <h3>Специальные уроки</h3>
                <button id="admin-add-special-lesson" class="admin-btn admin-btn-sm admin-btn-success">
                  <i class="fas fa-plus"></i> Добавить урок
                </button>
              </div>
              <div id="admin-special-lessons-list" class="admin-list"></div>
              <div class="admin-section-header" style="margin-top: 20px;">
                <h3>Уроки без дня</h3>
                <p>Уроки, доступные без выбора дня обучения, например "Словарь"</p>
              </div>
              <button id="admin-add-vocabulary" class="admin-btn admin-btn-success" style="margin-bottom: 10px;">
                <i class="fas fa-plus"></i> Добавить словарь
              </button>
              <div id="admin-no-day-lessons-list" class="admin-list"></div>
            </div>

            <!-- Настройки вебхуков -->
            <div id="admin-tab-webhooks" class="admin-tab-pane hidden">
              <div class="admin-section-header">
                <h3>Настройки вебхуков для импорта/экспорта данных</h3>
              </div>
              <div class="admin-form">
                <div class="admin-form-group">
                  <label for="admin-export-webhook-url">URL для экспорта данных:</label>
                  <input type="text" id="admin-export-webhook-url" class="admin-input" 
                         placeholder="https://example.com/webhook/export" 
                         value="https://auto.crm-s.com/webhook/SaveWebhooks">
                  <button class="admin-help-btn" data-modal="export-modal"><i class="fas fa-question-circle"></i></button>
                </div>
                <div class="admin-form-group">
                  <label for="admin-import-webhook-url">URL для импорта данных:</label>
                  <input type="text" id="admin-import-webhook-url" class="admin-input" 
                         placeholder="https://example.com/webhook/import">
                  <button class="admin-help-btn" data-modal="import-modal"><i class="fas fa-question-circle"></i></button>
                </div>
                <div class="admin-form-group">
                  <label for="admin-get-webhooks-url">URL для получения вебхуков:</label>
                  <input type="text" id="admin-get-webhooks-url" class="admin-input" 
                         placeholder="https://auto.crm-s.com/webhook-test/GetOnboardingHooks" 
                         value="https://auto.crm-s.com/webhook-test/GetOnboardingHooks">
                  <button class="admin-help-btn" data-modal="get-modal"><i class="fas fa-question-circle"></i></button>
                </div>
                <div style="margin-top: 20px;">
                  <button id="admin-save-webhooks" class="admin-btn admin-btn-primary">
                    <i class="fas fa-save"></i> Сохранить настройки
                  </button>
                  <button id="admin-test-export-webhook" class="admin-btn admin-btn-sm">
                    <i class="fas fa-upload"></i> Протестировать экспорт
                  </button>
                  <button id="admin-test-import-webhook" class="admin-btn admin-btn-sm">
                    <i class="fas fa-download"></i> Протестировать импорт
                  </button>
                  <button id="admin-get-webhooks" class="admin-btn admin-btn-primary admin-btn-sm">
                    <i class="fas fa-cloud-download-alt"></i> Получить вебхуки
                  </button>
                </div>
              </div>
              <div id="admin-webhook-status" style="margin-top: 20px; padding: 10px; border-radius: 4px;"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Редактирование дня -->
      <div id="admin-day-editor" class="admin-panel-section hidden">
        <div class="admin-section-header">
          <h2>Редактирование дня</h2>
          <div class="admin-section-actions">
            <button id="admin-save-day" class="admin-btn admin-btn-primary">Сохранить</button>
            <button id="admin-cancel-day" class="admin-btn">Отмена</button>
          </div>
        </div>

        <div class="admin-form">
          <div class="admin-form-group">
            <label for="admin-day-id">ID дня:</label>
            <input type="number" id="admin-day-id" class="admin-input" min="1">
          </div>
          <div class="admin-form-group">
            <label for="admin-day-title">Название дня:</label>
            <input type="text" id="admin-day-title" class="admin-input" placeholder="День 1">
          </div>

          <div class="admin-section-divider"></div>

          <div class="admin-section-header">
            <h3>Уроки</h3>
            <button id="admin-add-lesson" class="admin-btn admin-btn-sm admin-btn-success">
              <i class="fas fa-plus"></i> Добавить урок
            </button>
          </div>
          <div id="admin-lessons-list" class="admin-list"></div>
        </div>
      </div>

      <!-- Редактирование урока -->
      <div id="admin-lesson-editor" class="admin-panel-section hidden">
        <!-- Этот блок будет динамически заполняться из adminInterface.js -->
      </div>
    </div>  </div>

  <div class="admin-help-modal" id="export-modal">
    <div class="admin-help-modal-content">
      <span class="admin-help-modal-close" onclick="closeModal('export-modal')">&times;</span>
      <h3 class="admin-help-modal-title">URL для экспорта данных</h3>
      <p>Этот URL используется для экспорта данных о курсах. При отправке запроса на этот URL, сервер отправит данные в формате JSON.</p>
      <div class="json-example">
        <h4>Полный JSON формат при экспорте:</h4>
        <pre>{
  "courses": {
    "prompt-engineer": {
      "title": "Prompt Engineering Onboarding",
      "days": [
        {
          "id": 1,
          "title": "Day 1",
          "lessons": [
            {
              "id": "what-prompting-is",
              "title": "What prompting is",
              "contentSource": {
                "type": "webhook",
                "url": "https://auto.crm-s.com/webhook/PromptEngineering/WhatPromptingIs",
                "fallbackType": "local",
                "fallbackId": "what-prompting-is"
              },
              "testSource": {
                "type": "webhook",
                "url": "https://auto.crm-s.com/webhook/PromptEngineering/Tests/WhatPromptingIs",
                "fallbackType": "markdown",
                "fallbackId": "test-what-prompting-is"
              },
              "taskSource": {
                "type": "markdown",
                "content": "# Task: Create your first prompt\n\nCreate a prompt that asks the AI to explain what photosynthesis is to a 10-year-old child."
              },
              "audioSource": null
            },
            {
              "id": "five-step-framework",
              "title": "Five-step Framework",
              "contentSource": {
                "type": "webhook",
                "url": "https://auto.crm-s.com/webhook/Onboarding/PromptEngineer/FiveStepFramework",
                "fallbackType": "local",
                "fallbackId": "five-step-framework"
              },
              "testSource": {
                "type": "webhook",
                "url": "https://auto.crm-s.com/webhook/Oboarding/PromptEngineering/tests/FiveStepFramework"
              },
              "taskSource": {
                "type": "markdown",
                "content": "# Task: Apply the Five-step Framework\n\nUse the five-step framework to create a prompt that generates a recipe based on ingredients in your refrigerator."
              }
            },
            {
              "id": "personas-in-prompting",
              "title": "Personas in prompting",
              "contentSource": {
                "type": "webhook",
                "url": "https://auto.crm-s.com/webhook/Onboarding/PromptEngineer/PersonasInPrompting",
                "fallbackType": "local",
                "fallbackId": "personas-in-prompting"
              },
              "testSource": {
                "type": "webhook",
                "url": "https://auto.crm-s.com/webhook/Onboarding/PromptEngineering/Tests/PersonasInPrompting"
              },
              "taskSource": null
            }
          ]
        },
        {
          "id": 2,
          "title": "Day 2",
          "lessons": [
            {
              "id": "iteration-methods",
              "title": "Iteration methods",
              "contentSource": {
                "type": "webhook",
                "url": "https://auto.crm-s.com/webhook/Onboarding/PromptEngineer/IterationMethods",
                "fallbackType": "local",
                "fallbackId": "iteration-methods"
              },
              "testSource": {
                "type": "webhook",
                "url": "https://auto.crm-s.com/webhook/Onboarding/PromptEngineering/Test/IterationMethods"
              },
              "taskSource": null
            },
            {
              "id": "multimodal-prompting",
              "title": "Multimodal prompting",
              "contentSource": {
                "type": "webhook",
                "url": "https://auto.crm-s.com/webhook/Onboarding/PromptEngineering/MultimodalPrompting",
                "fallbackType": "local",
                "fallbackId": "multimodal-prompting"
              },
              "testSource": {
                "type": "webhook",
                "url": "https://auto.crm-s.com/webhook/Onboarding/PromptEngineer/Test/MultimodalPrompting"
              },
              "taskSource": null
            },
            {
              "id": "responsible-ai-use",
              "title": "Responsible AI Use",
              "contentSource": {
                "type": "webhook",
                "url": "https://hook.eu1.make.com/ya6a12917mjqwfx9lhpxf9wy3now3f4r"
              },
              "testSource": {
                "type": "webhook",
                "url": "https://hook.eu1.make.com/cjn0iv6d6l6pdpzv9of1bpohnv419omj"
              },
              "taskSource": null
            }
          ]
        }
      ],
      "specialLessons": [
        {
          "id": "vocabulary",
          "title": "Prompt Engineering Vocabulary",
          "contentSource": {
            "type": "webhook",
            "url": "https://auto.crm-s.com/webhook/PromptEngineering/Vocabulary",
            "fallbackType": "local",
            "fallbackId": "vocabulary"
          },
          "testSource": null,
          "audioSource": {
            "type": "soundcloud",
            "url": "https://soundcloud.com/developers-remote-helpers",
            "trackUrl": "https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/2028455920"
          }
        }
      ]
    },
    "lead-generator": {
      "redirectUrl": "https://hook.eu1.make.com/jcjl176nvrhlm4ag7qiixjzssxqdbl5n"
    }
  },
  "timestamp": "2023-10-25T12:45:22.543Z",
  "source": "onboarding-admin-interface",
  "version": "1.2.0",
  "exportId": "exp-2023102512452254"
}</pre>
      </div>
    </div>
  </div>

  <div class="admin-help-modal" id="import-modal">
    <div class="admin-help-modal-content">
      <span class="admin-help-modal-close" onclick="closeModal('import-modal')">&times;</span>
      <h3 class="admin-help-modal-title">URL для импорта данных</h3>
      <p>Этот URL используется для импорта данных о курсах. При отправке POST запроса на этот URL с данными в формате JSON, данные будут импортированы.</p>
      <div class="json-example">
        <h4>Полный JSON формат при импорте (последний импорт):</h4>
        <pre>{
  "courses": {
    "prompt-engineer": {
      "title": "Prompt Engineering Onboarding",
      "days": [
        {
          "id": 1,
          "title": "Day 1",
          "lessons": [
            {
              "id": "what-prompting-is",
              "title": "What prompting is",
              "contentSource": {
                "type": "webhook",
                "url": "https://auto.crm-s.com/webhook/PromptEngineering/WhatPromptingIs",
                "fallbackType": "local",
                "fallbackId": "what-prompting-is"
              },
              "testSource": {
                "type": "webhook",
                "url": "https://auto.crm-s.com/webhook/PromptEngineering/Tests/WhatPromptingIs",
                "fallbackType": "markdown",
                "fallbackId": "test-what-prompting-is"
              },
              "taskSource": {
                "type": "markdown",
                "content": "# Task: Create your first prompt\n\nCreate a prompt that asks the AI to explain what photosynthesis is to a 10-year-old child."
              },
              "audioSource": null
            },
            {
              "id": "five-step-framework",
              "title": "Five-step Framework",
              "contentSource": {
                "type": "webhook",
                "url": "https://auto.crm-s.com/webhook/Onboarding/PromptEngineer/FiveStepFramework",
                "fallbackType": "local",
                "fallbackId": "five-step-framework"
              },
              "testSource": {
                "type": "webhook",
                "url": "https://auto.crm-s.com/webhook/Oboarding/PromptEngineering/tests/FiveStepFramework"
              },
              "taskSource": {
                "type": "markdown",
                "content": "# Task: Apply the Five-step Framework\n\nUse the five-step framework to create a prompt that generates a recipe based on ingredients in your refrigerator."
              }
            },
            {
              "id": "personas-in-prompting",
              "title": "Personas in prompting",
              "contentSource": {
                "type": "webhook",
                "url": "https://auto.crm-s.com/webhook/Onboarding/PromptEngineer/PersonasInPrompting",
                "fallbackType": "local",
                "fallbackId": "personas-in-prompting"
              },
              "testSource": {
                "type": "webhook",
                "url": "https://auto.crm-s.com/webhook/Onboarding/PromptEngineering/Tests/PersonasInPrompting"
              },
              "taskSource": null
            }
          ]
        },
        {
          "id": 2,
          "title": "Day 2",
          "lessons": [
            {
              "id": "iteration-methods",
              "title": "Iteration methods",
              "contentSource": {
                "type": "webhook",
                "url": "https://auto.crm-s.com/webhook/Onboarding/PromptEngineer/IterationMethods",
                "fallbackType": "local",
                "fallbackId": "iteration-methods"
              },
              "testSource": {
                "type": "webhook",
                "url": "https://auto.crm-s.com/webhook/Onboarding/PromptEngineering/Test/IterationMethods"
              },
              "taskSource": null
            }
          ]
        }
      ],
      "specialLessons": [
        {
          "id": "vocabulary",
          "title": "Prompt Engineering Vocabulary",
          "contentSource": {
            "type": "webhook",
            "url": "https://auto.crm-s.com/webhook/PromptEngineering/Vocabulary",
            "fallbackType": "local",
            "fallbackId": "vocabulary"
          },
          "testSource": null,
          "audioSource": {
            "type": "soundcloud",
            "url": "https://soundcloud.com/developers-remote-helpers",
            "trackUrl": "https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/2028455920"
          }
        }
      ]
    },
    "lead-generator": {
      "redirectUrl": "https://hook.eu1.make.com/jcjl176nvrhlm4ag7qiixjzssxqdbl5n"
    }
  },
  "status": "success",
  "importId": "imp-20231015095712",
  "importDate": "2023-10-15T09:57:12.321Z",
  "importedBy": "admin-system",
  "importSource": "webhook-sync",
  "validationResults": {
    "status": "valid",
    "warnings": [],
    "errors": []
  }
}</pre>
      </div>
    </div>
  </div>

  <div class="admin-help-modal" id="get-modal">
    <div class="admin-help-modal-content">
      <span class="admin-help-modal-close" onclick="closeModal('get-modal')">&times;</span>
      <h3 class="admin-help-modal-title">URL для получения вебхуков</h3>
      <p>Этот URL используется для получения списка всех настроенных вебхуков. При отправке GET запроса на этот URL, сервер вернет список вебхуков в формате JSON.</p>
      <div class="json-example">
        <h4>Полный JSON формат списка вебхуков:</h4>
        <pre>{
  "webhooks": [
    {
      "id": "export_courses_hook",
      "url": "https://auto.crm-s.com/webhook/SaveWebhooks",
      "type": "export",
      "description": "Экспорт данных курсов",
      "method": "POST",
      "headers": {
        "Content-Type": "application/json",
        "X-API-Key": "API_KEY_VALUE",
        "X-Integration-Source": "onboarding-admin"
      },
      "active": true,
      "lastUsed": "2023-10-20T08:12:34.567Z",
      "successRate": 98.5,
      "retryPolicy": {
        "attempts": 3,
        "backoffMultiplier": 1.5
      }
    },
    {
      "id": "import_courses_hook",
      "url": "https://auto.crm-s.com/webhook/GetCourses",
      "type": "import",
      "description": "Импорт данных курсов",
      "method": "GET",
      "headers": {
        "Accept": "application/json",
        "X-API-Key": "API_KEY_VALUE",
        "X-Integration-Source": "onboarding-admin"
      },
      "active": true,
      "lastUsed": "2023-10-22T14:45:11.234Z",
      "successRate": 100,
      "retryPolicy": {
        "attempts": 2,
        "backoffMultiplier": 2
      }
    },
    {
      "id": "notify_updates_hook",
      "url": "https://auto.crm-s.com/webhook/NotifyUpdates",
      "type": "notification",
      "description": "Уведомление о изменениях в курсах",
      "method": "POST",
      "headers": {
        "Content-Type": "application/json",
        "X-API-Key": "API_KEY_VALUE"
      },
      "active": true,
      "lastUsed": "2023-10-21T11:30:45.678Z",
      "successRate": 95.7,
      "retryPolicy": {
        "attempts": 3,
        "backoffMultiplier": 1.5
      },
      "notificationConfig": {
        "triggerEvents": ["course.created", "course.updated", "lesson.created"],
        "includeDetails": true
      }
    }
  ],
  "total": 3,
  "timestamp": "2023-10-25T09:15:32.456Z",
  "apiVersion": "1.2",
  "quota": {
    "daily": 1000,
    "used": 125,
    "reset": "2023-10-26T00:00:00.000Z"
  },
  "pagination": {
    "page": 1,
    "perPage": 20,
    "totalPages": 1,
    "totalItems": 3
  }
}</pre>
      </div>
    </div>
  </div>

  <script type="module">
    import courseManager from './js/courseManager.js';
    import adminInterface from './js/adminInterface.js';
    import devMode from './js/devMode.js';

    // Инициализируем приложение после загрузки DOM
    document.addEventListener('DOMContentLoaded', async function() {
      console.log("Страница администратора загружена, инициализация...");

      // Инициализируем менеджер курсов
      await courseManager.initialize();

      // Инициализируем и показываем административный интерфейс
      await adminInterface.initialize();
      adminInterface.show();

      // Глобальный доступ к менеджеру курсов и административному интерфейсу
      window.courseManager = courseManager;
      window.adminInterface = adminInterface;


      // Обработчики для кнопок справки
      const helpButtons = document.querySelectorAll('.admin-help-btn');
      helpButtons.forEach(button => {
        button.addEventListener('click', () => {
          const modalId = button.dataset.modal;
          openModal(modalId);
        });
      });

      function openModal(modalId) {
        const modal = document.getElementById(modalId);
        modal.style.display = 'block';
      }

      function closeModal(modalId) {
        const modal = document.getElementById(modalId);
        modal.style.display = 'none';
      }
    });

    // Определяем closeModal как глобальную функцию для доступа из атрибутов onclick
    window.closeModal = function(modalId) {
      const modal = document.getElementById(modalId);
      if (modal) {
        modal.style.display = 'none';
      }
    };
  </script>
</body>
</html>