<!DOCTYPE html>
<html lang="ru">
<head>
  <link type="image/png" sizes="16x16" rel="icon" href="https://i.postimg.cc/gJf9MgWR/icons8-32.png">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Onboarding for Prompt Engineers</title>
  <!-- Подключаем marked.js для парсинга Markdown -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #f0f0f0;
      font-size: 16px;
    }
    .container {
      padding: 15px;
      max-width: 100%;
      box-sizing: border-box;
    }
    .hidden {
      display: none;
    }
    .center {
      text-align: center;
    }
    button {
      padding: 12px 20px;
      margin: 8px 5px;
      cursor: pointer;
      border: none;
      background-color: #4CAF50;
      color: white;
      border-radius: 5px;
      width: auto;
      font-size: 16px;
      display: inline-block;
    }
    button:hover {
      background-color: #45a049;
    }
    select, input {
      font-size: 16px;
      padding: 10px;
      margin: 5px 0;
      width: 100%;
      max-width: 300px;
      box-sizing: border-box;
    }
    .spinner {
      border: 6px solid #f3f3f3;
      border-top: 6px solid #3498db;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 2s linear infinite;
      margin: 20px auto;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    .markdown-content {
      font-size: 16px;
      line-height: 1.5;
      overflow-wrap: break-word;
      word-wrap: break-word;
    }
    .markdown-content p {
      margin: 10px 0;
    }
    .markdown-content ul {
      margin: 10px 5px;
      padding-left: 20px;
    }
    .markdown-content table {
      border-collapse: collapse;
      width: 100%;
      margin: 10px 0;
      display: block;
      overflow-x: auto;
    }
    .markdown-content table,
    .markdown-content th,
    .markdown-content td {
      border: 1px solid #ddd;
    }
    .markdown-content th,
    .markdown-content td {
      padding: 8px;
      text-align: left;
      min-width: 100px;
    }
    details {
      background: #fff;
      margin: 10px 0;
      padding: 10px;
      border-radius: 5px;
    }
    summary {
      cursor: pointer;
      padding: 10px 0;
    }
    details > summary {
      font-size: 1.1em;
      font-weight: bold;
    }
    details details > summary {
      font-size: 0.9em;
      font-weight: bold;
    }
    details details details > summary {
      font-size: 0.8em;
      font-weight: bold;
    }
    .markdown-content pre {
      background-color: #f9f9f9;
      border-left: 4px solid #ccc;
      padding: 10px;
      overflow-x: auto;
      white-space: pre-wrap;
      word-wrap: break-word;
      margin: 10px 0;
      font-size: 14px;
    }
    .markdown-content code {
      background-color: #f9f9f9;
      padding: 2px 4px;
      border-radius: 3px;
      font-size: 14px;
    }
    
    /* Адаптивные стили для мобильных устройств */
    @media (max-width: 768px) {
      h1 {
        font-size: 1.5em;
      }
      button {
        width: 100%;
        margin: 8px 0;
        padding: 12px 10px;
      }
      .container {
        padding: 10px;
      }
      .task-buttons button {
        display: block;
        width: 100%;
      }
      details > summary {
        font-size: 1em;
      }
      .admin-panel {
        overflow: auto;
      }
      iframe {
        max-width: 100%;
        height: auto;
      }
    }
    
    /* Стили для очень маленьких экранов */
    @media (max-width: 400px) {
      h1 {
        font-size: 1.3em;
      }
      button {
        font-size: 14px;
      }
      .container {
        padding: 8px;
      }
    }
  </style>
</head>
<body>
  <!-- Домашняя страница -->
  <div id="home" class="container center">
    <div id="day-selection">
      <h1>Prompt Engineering Onboarding</h1>
      <p>
        Profession:&nbsp;
        <select id="profession-select" onchange="handleProfessionChange()">
          <option value="prompt-engineer">Prompt Engineer</option>
          <option value="lead-generator">Lead Generator</option>
        </select>
      </p>

      <div style="margin: 30px 0;">
        <p>Quick Reference:</p>
        <button onclick="openVocabulary()">Prompt Engineering Vocabulary</button>
      </div>

      <div style="margin-top: 30px;">
        <p>Select Training Day:</p>
        <button onclick="selectDay(1)">Day 1</button>
        <button onclick="selectDay(2)">Day 2</button>
      </div>
      
      <div id="admin-access" style="margin-top: 30px;">
        <a href="admin.html" style="text-decoration: none;">
          <button style="background-color: #3498db;">Управление курсами</button>
        </a>
      </div>
    </div>
    <div id="task-selection" class="hidden">
      <h1 id="day-header"></h1>
      <div id="task-buttons" class="task-buttons"></div>
      <button onclick="goBackToDaySelection()">Back</button>
    </div>
  </div>

  <!-- Страница гайда -->
  <div id="guide" class="container hidden">
    <h1 id="guide-title">Guide:</h1>
    <div id="loading-spinner" class="center">
      <div class="spinner"></div>
      <p>Loading, please wait...</p>
    </div>

    <!-- Аудио-блок для первого урока -->
    <div id="audio-first-lesson" class="hidden center" style="margin-bottom: 20px;">
      <iframe width="100%" height="300" scrolling="no" frameborder="no" allow="autoplay"
              src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/2041898968&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true">
      </iframe>
      <div style="font-size: 10px; color: #cccccc;line-break: anywhere;word-break: normal;overflow: hidden;white-space: nowrap;text-overflow: ellipsis; font-family: Interstate,Lucida Grande,Lucida Sans Unicode,Lucida Sans,Garuda,Verdana,Tahoma,sans-serif;font-weight: 100;">
        <a href="https://soundcloud.com/content-remote-helpers" title="Content Remote Helpers" target="_blank" style="color: #cccccc; text-decoration: none;">Content Remote Helpers</a> · <a href="https://soundcloud.com/content-remote-helpers/screen-recording-audio" title="First Lesson Audio" target="_blank" style="color: #cccccc; text-decoration: none;">First Lesson Audio</a>
      </div>
    </div>

    <!-- Аудио-блок для Vocabulary -->
    <div id="audio-vocabulary" class="hidden center" style="margin-bottom: 20px;">
      <iframe width="100%" height="300" scrolling="no" frameborder="no" allow="autoplay"
              src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/2028455920&color=%230066cc&auto_play=false">
      </iframe>
      <div style="font-size: 10px; color: #cccccc; white-space: nowrap;">
        <a href="https://soundcloud.com/developers-remote-helpers" target="_blank" style="color: #cccccc; text-decoration: none;">
          Developers Remote Helpers</a> ·
        <a href="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/2028455920" target="_blank" style="color: #cccccc; text-decoration: none;">
          Prompt Engineering Vocabulary</a>
      </div>
    </div>

    <!-- Контейнер для Markdown контента -->
    <div id="markdown-content" class="markdown-content hidden"></div>

    <!-- Кнопка Test для выбранного модуля -->
    <div class="center" style="margin-top:20px;">
      <button id="test-button" onclick="window.location.href = currentTopic.testWebhook">Test</button>
    </div>
    <!-- Кнопка Back для возврата к списку топиков -->
    <div class="center" style="margin-top:20px;">
      <button onclick="goBackToTaskSelection()">Back</button>
    </div>
  </div>

  <script type="module">
    // Импортируем модули приложения
    import courseManager from './js/courseManager.js';
    import adminPanel from './js/admin.js';
    
    // Инициализируем приложение после загрузки DOM
    document.addEventListener('DOMContentLoaded', async function() {
      console.log("Page loaded, initializing application...");
      
      // Инициализируем менеджер курсов
      await courseManager.initialize();
      
      // При необходимости можно открыть админ-панель
      // adminPanel.show();
      
      // Глобальный доступ к менеджеру курсов и админ-панели
      window.courseManager = courseManager;
      window.adminPanel = adminPanel;
    });
  </script>
  
  <script>
    // Обратная совместимость со старым кодом 
    // Глобальные переменные для текущей темы и выбранного дня
    window.currentTopic = null;
    window.currentDay = null;
    let currentTasks = [];

    const professionTasks = {
      "prompt-engineer": {
        1: [
          { 
            title: "What prompting is",
            contentWebhook: "https://auto.crm-s.com/webhook/PromptEngineering/WhatPromptingIs",
            testWebhook: "https://auto.crm-s.com/webhook/PromptEngineering/Tests/WhatPromptingIs" 
          },
          { 
            title: "Five-step Framework",
            contentWebhook: "https://auto.crm-s.com/webhook/Onboarding/PromptEngineer/FiveStepFramework",
            testWebhook: "https://auto.crm-s.com/webhook/Oboarding/PromptEngineering/tests/FiveStepFramework" 
          },
          { 
            title: "Personas in prompting",
            contentWebhook: "https://auto.crm-s.com/webhook/Onboarding/PromptEngineer/PersonasInPrompting",
            testWebhook: "https://auto.crm-s.com/webhook/Onboarding/PromptEngineering/Tests/PersonasInPrompting" 
          }
        ],
        2: [
          {
            title: "Iteration methods",
            contentWebhook: "https://auto.crm-s.com/webhook/Onboarding/PromptEngineer/IterationMethods",
            testWebhook: "https://auto.crm-s.com/webhook/Onboarding/PromptEngineering/Test/IterationMethods"
          },
          {
            title: "multimodal prompting",
            contentWebhook: "https://auto.crm-s.com/webhook/Onboarding/PromptEngineering/MultimodalPrompting",
            testWebhook: "https://auto.crm-s.com/webhook/Onboarding/PromptEngineer/Test/MultimodalPrompting"
          },
          {
            title: "responsible AI Use",
            contentWebhook: "https://hook.eu1.make.com/ya6a12917mjqwfx9lhpxf9wy3now3f4r",
            testWebhook: "https://hook.eu1.make.com/cjn0iv6d6l6pdpzv9of1bpohnv419omj"
          }
        ]
      }
    };

    // Отдельный объект для словаря
    const vocabularyTopic = {
      title: "Prompt Engineering Vocabulary",
      contentWebhook: "https://auto.crm-s.com/webhook/PromptEngineering/Vocabulary",
      testWebhook: "placeholder-test-webhook-vocabulary"
    };

    // Функция для обработки изменения профессии
    function handleProfessionChange() {
      const selectedProfession = document.getElementById("profession-select").value;
      if (selectedProfession === "lead-generator") {
        window.location.href = "https://hook.eu1.make.com/jcjl176nvrhlm4ag7qiixjzssxqdbl5n";
      }
    }

    function selectDay(day) {
      window.currentDay = day;
      const selectedProfession = document.getElementById("profession-select").value;
      // Используем deep copy, чтобы не изменялись исходные данные
      currentTasks = JSON.parse(JSON.stringify(professionTasks[selectedProfession][day]));
      const dayHeader = document.getElementById("day-header");
      if (dayHeader) dayHeader.innerText = "Day " + day;
      const daySelection = document.getElementById("day-selection");
      if (daySelection) daySelection.classList.add("hidden");
      const taskSelection = document.getElementById("task-selection");
      if (taskSelection) taskSelection.classList.remove("hidden");
      const taskButtonsDiv = document.getElementById("task-buttons");
      if (taskButtonsDiv) {
        taskButtonsDiv.innerHTML = "";
        currentTasks.forEach((task, index) => {
          const btn = document.createElement("button");
          btn.innerText = task.title;
          btn.onclick = function() { selectTask(index); };
          taskButtonsDiv.appendChild(btn);
        });
      }
    }

    function goBackToDaySelection() {
      const taskSelection = document.getElementById("task-selection");
      if (taskSelection) taskSelection.classList.add("hidden");
      const daySelection = document.getElementById("day-selection");
      if (daySelection) daySelection.classList.remove("hidden");
    }

    // Функция возврата к списку топиков – обновляет его через selectDay с сохранённым днем и сбрасывает выбранный топик
    function goBackToTaskSelection() {
      hideAllAudio();
      const markdownDiv = document.getElementById("markdown-content");
      if (markdownDiv) markdownDiv.innerHTML = "";
      window.currentTopic = null;
      const home = document.getElementById("home");
      if (home) home.classList.remove("hidden");
      if (window.currentDay !== null) {
        selectDay(window.currentDay);
      }
      const guide = document.getElementById("guide");
      if (guide) guide.classList.add("hidden");
    }

    window.goBack = function() {
      showSection("home");
      const daySelection = document.getElementById("day-selection");
      if (daySelection) daySelection.classList.remove("hidden");
      const taskSelection = document.getElementById("task-selection");
      if (taskSelection) taskSelection.classList.add("hidden");
    };

    // Функция для открытия словаря
    function openVocabulary() {
      window.currentTopic = vocabularyTopic;
      const guideTitle = document.getElementById("guide-title");
      if (guideTitle) guideTitle.innerText = "Guide: " + window.currentTopic.title;
      hideAllAudio();
      // Аудио для Vocabulary остается скрытым
      // Скрываем кнопку теста для словаря
      document.getElementById("test-button").classList.add("hidden");
      showSection("guide");
      fetchMarkdownContent();
    }

    function selectTask(index) {
      window.currentTopic = currentTasks[index];
      const guideTitle = document.getElementById("guide-title");
      if (guideTitle) guideTitle.innerText = "Guide: " + window.currentTopic.title;
      hideAllAudio();
      // Показываем кнопку теста для обычных тем
      document.getElementById("test-button").classList.remove("hidden");
      showSection("guide");
      fetchMarkdownContent();
    }

    function hideAllAudio() {
      const audioIds = [
        "audio-first-lesson",
        "audio-vocabulary"
      ];
      audioIds.forEach(id => {
        const el = document.getElementById(id);
        if (el) el.classList.add("hidden");
      });
    }

    function showSection(id) {
      const home = document.getElementById("home");
      if (home) home.classList.add("hidden");
      const guide = document.getElementById("guide");
      if (guide) guide.classList.add("hidden");
      const target = document.getElementById(id);
      if (target) target.classList.remove("hidden");
    }

    function fetchMarkdownContent() {
      const url = window.currentTopic.contentWebhook;
      const spinner = document.getElementById("loading-spinner");
      if (spinner) spinner.classList.remove("hidden");
      const markdownDiv = document.getElementById("markdown-content");
      if (markdownDiv) markdownDiv.classList.add("hidden");

      if (!url || url.startsWith("placeholder")) {
        if (spinner) spinner.classList.add("hidden");
        if (markdownDiv) {
          markdownDiv.classList.remove("hidden");
          markdownDiv.innerHTML = "<p>Placeholder content: Content will be added soon!</p>";
        }
        return;
      }

      // Больше не создаем options здесь, все параметры запроса определены внутри fetchContent

      // Enhanced fetch with better error handling, debugging and fallbacks
      const fetchContent = async (url, options) => {
        try {
          console.log("Fetching from:", url);
          
          // Check if URL has a typo in "Onboarding" - common error pattern
          const fixedUrl = url.replace("/Oboarding/", "/Onboarding/");
          if (fixedUrl !== url) {
            console.log("Detected possible URL typo, trying with fixed URL:", fixedUrl);
            url = fixedUrl;
          }
          
          // Add a timeout to the fetch operation
          const controller = new AbortController();
          const timeoutId = setTimeout(() => {
            controller.abort();
            console.error("Fetch timeout after 15 seconds");
          }, 15000); // 15 second timeout
          
          // Всегда используем GET-запрос без тела для упрощения CORS
          const fetchOptions = {
            method: 'GET',
            headers: {
              'Accept': 'text/plain, text/markdown, application/json, */*'
            },
            mode: 'cors',
            cache: 'no-cache',
            credentials: 'omit',
            signal: controller.signal
          };
          
          console.log("Using simplified GET request");
          
          // Try with standard fetch first
          try {
            const response = await fetch(url, fetchOptions);
            clearTimeout(timeoutId);
            
            console.log("Response status:", response.status);
            
            if (!response.ok) {
              const errorText = await response.text().catch(e => "Unable to read response body");
              throw new Error(`HTTP error! Status: ${response.status}, Status Text: ${response.statusText}, Response: ${errorText.substring(0, 500)}`);
            }
            
            const responseText = await response.text();
            console.log("Response size:", responseText.length, "bytes");
            console.log("Response preview:", responseText.substring(0, 100));
            return responseText;
          } catch (fetchError) {
            // Если основной запрос не удался, используем резервное содержимое
            console.error("Fetch failed:", fetchError.message);
            
            // Предоставляем резервное содержимое на основе URL
            if (url.includes("IterationMethods")) {
              console.log("Using backup content for IterationMethods");
              return getBackupContentForIterationMethods();
            } else if (url.includes("FiveStepFramework")) {
              console.log("Using backup content for FiveStepFramework");
              return getBackupContentForFiveStepFramework();
            } else if (url.includes("PersonasInPrompting")) {
              console.log("Using backup content for PersonasInPrompting");
              return getBackupContentForPersonasInPrompting();
            } else if (url.includes("WhatPromptingIs")) {
              console.log("Using backup content for WhatPromptingIs");
              return getBackupContentForWhatPromptingIs();
            } else if (url.includes("Vocabulary")) {
              console.log("Using backup content for Vocabulary");
              return getBackupContentForVocabulary();
            } else {
              // Если резервное содержимое недоступно, генерируем базовый контент
              console.log("No specific backup content available, using generic fallback");
              return `# ${window.currentTopic ? window.currentTopic.title : "Контент недоступен"}

Не удалось загрузить содержимое для данного урока. Возможные причины:

- Временная проблема с сервером
- Проблемы с сетевым подключением
- Проблемы с CORS (Cross-Origin Resource Sharing)

Пожалуйста, попробуйте позже или обратитесь к руководителю команды.`;
            }
          }
        } catch (error) {
          console.error("Fetch error:", error.message || "Unknown fetch error");
          console.error("Error object:", JSON.stringify({
            name: error.name,
            message: error.message,
            stack: error.stack
          }));
          throw error; // Re-throw to be handled by the outer catch
        }
      };
      
      // Fallback content functions
      function getBackupContentForWhatPromptingIs() {
        return `# What prompting is

Prompting is a technique used to communicate with AI language models by providing them with specific instructions or input texts that guide their responses. It's the primary way humans interact with Large Language Models (LLMs) like ChatGPT, Claude, or Gemini.

## Why Prompts Matter

Effective prompts are crucial because they directly influence the quality and relevance of AI responses. The same AI model can generate dramatically different outputs based solely on how a prompt is phrased.

## Key Components of Prompts

### Instructions
Clear directions telling the AI what to do, how to respond, or what format to use.

### Context
Background information that helps the AI understand the topic or situation.

### Examples
Demonstrations of desired outputs that help the AI understand exactly what you want.

### Constraints
Limitations or boundaries that define what the AI should or shouldn't do.

## Different Types of Prompting

### Basic Prompting
Simple questions or statements that request information.
Example: "Explain what photosynthesis is."

### Role-Based Prompting
Asking the AI to assume a specific persona or role.
Example: "As an expert botanist, explain what photosynthesis is."

### Few-Shot Prompting
Providing examples in the prompt to guide the AI's response format.
Example: "Q: What is the capital of France? A: Paris. Q: What is the capital of Japan? A:"

### Chain-of-Thought Prompting
Encouraging the AI to reason step-by-step through a problem.
Example: "Think step by step to solve this math problem: If x + y = 10 and x - y = 4, what are x and y?"

## Prompt Engineering

The practice of designing and refining prompts to get the best possible responses from AI is called prompt engineering. It has become a valuable skill as AI systems become more widespread.

Good prompt engineers understand:
- How different prompting techniques affect AI outputs
- Common pitfalls and how to avoid them
- How to iterate and refine prompts
- How to evaluate AI responses

## The Prompt Engineering Workflow

1. Define your goal clearly
2. Design an initial prompt
3. Evaluate the response
4. Refine the prompt based on the response
5. Repeat until satisfied with the result

The following lessons will explore these concepts in more detail and provide practical exercises to develop your prompt engineering skills.`;
      }
      
      function getBackupContentForVocabulary() {
        return `# Prompt Engineering Vocabulary

## Core Concepts

### Prompt
A text input given to an AI model that guides its response. This can include questions, instructions, examples, or constraints.

### Large Language Model (LLM)
An AI system trained on vast amounts of text data that can generate human-like text, understand context, and follow instructions.

### Prompt Engineering
The practice of designing and refining prompts to effectively communicate with AI models to get desired outputs.

### Token
The basic unit of text that LLMs process. A token can be a word, part of a word, or a character, depending on the model's tokenization method.

### Context Window
The maximum amount of text (measured in tokens) that an AI model can consider at once, including both the prompt and the generated response.

## Prompting Techniques

### Zero-shot Prompting
Asking an AI to perform a task without providing any examples.
Example: "Translate this sentence to French: 'Hello, how are you?'"

### Few-shot Prompting
Providing the AI with a few examples within the prompt to guide its response format or style.
Example: "English: Hello, French: Bonjour, English: Thank you, French: ?"

### Chain-of-Thought (CoT)
Prompting technique that encourages the AI to show its reasoning process step-by-step.
Example: "Think step by step to solve this math problem."

### Tree of Thoughts
An extension of Chain-of-Thought that explores multiple reasoning paths before arriving at a final answer.

### Role Prompting
Instructing the AI to assume a specific role or persona.
Example: "As an experienced chef, provide feedback on this recipe."

### Retrieval-Augmented Generation (RAG)
Combining an LLM with the ability to retrieve information from an external knowledge base during generation.

## Best Practices

### Specificity
Being clear and detailed in what you're asking the AI to do.

### Structured Format
Organizing prompts with clear sections like "Context," "Instructions," and "Format."

### Constraints
Setting boundaries on what the AI should or shouldn't include in its response.

### Iteration
The process of refining prompts based on the AI's responses to improve results over time.

## Common Challenges

### Prompt Injection
A security concern where malicious instructions are hidden within benign-looking prompts to manipulate the AI's behavior.

### Hallucination
When an AI confidently generates incorrect information that wasn't in its training data.

### Model Alignment
The degree to which an AI's outputs match human values, intentions, and expectations.

### Context Truncation
When a prompt is too long and exceeds the model's context window, causing information loss.`;
      }
      
      function getBackupContentForIterationMethods() {
        return `# Iteration Methods

Iteration is a key skill in prompt engineering that focuses on refining prompts through multiple rounds to improve AI responses. By analyzing responses and making targeted adjustments, prompt engineers can significantly enhance the quality and relevance of AI outputs.

## Understanding Iteration

Iteration involves:
- Starting with an initial prompt
- Analyzing the response for issues
- Making specific adjustments to the prompt
- Testing the revised prompt
- Repeating the process until achieving satisfactory results

## Common Iteration Techniques

### 1. Adding Constraints

**Problem:** AI response is too general or verbose.
**Solution:** Add specific constraints to narrow the focus.

**Before:** "Write about climate change."
**After:** "Write a 250-word explanation of climate change focusing only on scientific consensus and avoiding political discussion."

### 2. Providing Examples (Few-Shot Learning)

**Problem:** AI doesn't understand the format or style you want.
**Solution:** Include examples in your prompt.

**Before:** "Translate this text to French."
**After:** "Translate this text to French. For example: 'Hello' → 'Bonjour', 'Thank you' → 'Merci'"

### 3. Clarifying Instructions

**Problem:** AI misunderstands part of the request.
**Solution:** Rewrite instructions to be more precise and eliminate ambiguity.

**Before:** "Write a good intro for my paper on quantum computing."
**After:** "Write a 100-word academic introduction paragraph for a research paper on quantum computing applications in cryptography. Include a clear thesis statement and highlight the importance of the topic."

### 4. Breaking Down Complex Requests

**Problem:** AI responses to complex prompts are incomplete or confused.
**Solution:** Split complex tasks into smaller, sequential prompts.

**Before:** "Create a marketing strategy for my new tech product including target audience, messaging, channels, and budget allocation."
**After:** "First, help me identify a target audience for my new productivity app. Once we've established that, we'll work on messaging, then channels, and finally budget allocation."

### 5. Adjusting Tone and Persona

**Problem:** AI's voice doesn't match your needs.
**Solution:** Explicitly specify the tone and perspective.

**Before:** "Write about the benefits of meditation."
**After:** "As a meditation instructor with 10 years of experience, write about the benefits of daily meditation practice. Use a warm, encouraging tone that would motivate beginners."

## Systematic Iteration Process

1. **Identify the specific issue** - What exactly is wrong with the current response?
2. **Formulate a hypothesis** - Why might the AI be producing this result?
3. **Make targeted changes** - Adjust only one or two elements at a time.
4. **Test and analyze** - Evaluate whether the changes improved the output.
5. **Document findings** - Keep track of what works and what doesn't.

## Best Practices

- **Make incremental changes** - Change one element at a time to understand its impact.
- **Keep a prompt journal** - Document your prompts and the resulting outputs.
- **Test with variations** - Try slight variations of successful prompts to find optimal formulations.
- **Look for patterns** - Notice which types of adjustments consistently improve results.
- **Consider model limitations** - Some issues might be inherent to the model rather than the prompt.

By mastering iteration techniques, prompt engineers can dramatically improve AI outputs while developing an intuitive understanding of how different prompt elements affect results.`;
      }
      
      function getBackupContentForFiveStepFramework() {
        return `# Five-step Framework for Prompt Engineering

The Five-step Framework provides a structured approach to designing effective prompts for AI systems. Each step builds upon the previous one to create prompts that yield accurate, relevant, and useful responses.

## Step 1: Define the Goal

Before writing any prompt, clearly define what you want to achieve.

**Key Questions:**
- What specific output or information do you need?
- What format should the response take?
- Who is the end-user of this information?

**Example:**
Goal: "I need a comprehensive comparison of solar panel types for residential use that helps homeowners make an informed decision."

## Step 2: Provide Context

Give the AI relevant background information to ensure it understands the situation.

**Key Elements:**
- Relevant facts and data
- Audience information
- Domain-specific context
- Any constraints or requirements

**Example:**
"I'm creating content for middle-aged homeowners in sunny Arizona who are considering installing solar panels. They have limited technical knowledge but are environmentally conscious and budget-aware."

## Step 3: Specify Instructions

Clearly state what you want the AI to do and how it should do it.

**Key Components:**
- Task description
- Output format
- Tone and style guidance
- Length requirements

**Example:**
"Create a comparison table of the three most common residential solar panel types (monocrystalline, polycrystalline, and thin-film). Follow the table with 2-3 paragraphs explaining the key differences in layman's terms. Use a friendly but informative tone."

## Step 4: Use Constraints

Set boundaries to prevent unwanted content and guide the AI toward your desired outcome.

**Types of Constraints:**
- Content limitations
- Style restrictions
- Length parameters
- Ethical guardrails

**Example:**
"Avoid technical jargon without explanation. Don't include DIY installation instructions, as these systems require professional installation. Limit the response to 500 words."

## Step 5: Review and Refine

Analyze the AI's response and iterate on your prompt to improve results.

**Review Process:**
1. Evaluate the response against your goal
2. Identify missing or incorrect information
3. Note areas where instructions weren't followed
4. Adjust your prompt accordingly

**Example:**
"The information is good, but there's too much emphasis on cost and not enough on durability. Let me adjust my prompt to prioritize long-term value and performance in extreme weather conditions."

## Putting It All Together

A complete prompt using the Five-step Framework might look like:

"I need a comparison of residential solar panel types (Goal). This is for middle-aged homeowners in Arizona with limited technical knowledge but environmental awareness (Context). Create a table comparing monocrystalline, polycrystalline, and thin-film panels, followed by 2-3 explanatory paragraphs in layman's terms (Instructions). Avoid unexplained jargon and DIY installation details, and prioritize information on durability and performance in hot climates. Limit to 500 words (Constraints)."

By following this framework, you can systematically improve your prompts through each iteration, leading to increasingly accurate and useful AI responses.`;
      }
      
      function getBackupContentForPersonasInPrompting() {
        return `# Personas in Prompting

## What are Personas?

Personas in prompt engineering refer to fictional characters or roles that you ask an AI to assume when responding to your prompt. By assigning a specific persona, you can guide the AI to leverage domain-specific knowledge, vocabulary, and reasoning approaches.

## Why Use Personas?

Using personas provides several key benefits:

### Expertise Access
By asking the AI to respond as an expert in a particular field, you can get more specialized information.

### Perspective Shifting
Different personas can provide varied viewpoints on the same question or problem.

### Tone Control
Personas help shape the style, formality, and tone of the AI's response.

### Problem-Solving Approaches
Different personas may use different methodologies to approach a problem.

## Types of Personas

### Expert Personas
These personas represent specialists in specific fields.

**Examples:**
- "As a quantum physicist..."
- "Respond as an experienced pediatrician..."
- "Taking the role of a cybersecurity expert..."

### Character Personas
These include fictional characters, historical figures, or archetypal roles.

**Examples:**
- "Explain this as if you were Sherlock Holmes..."
- "As a medieval blacksmith, describe..."
- "Channel the perspective of Leonardo da Vinci to..."

### Function-Based Personas
These personas focus on a specific task or function rather than expertise.

**Examples:**
- "Act as a summarizer..."
- "As a fact-checker, review..."
- "In the role of a debate moderator..."

## Best Practices

### Be Specific
Define the persona's characteristics clearly. Instead of just "as a scientist," try "as a marine biologist specializing in coral reef ecosystems."

### Provide Context
Give background information that helps the persona understand their role in responding.

### Add Constraints
Specify what the persona should or shouldn't focus on.

### Combine with Other Techniques
Personas work well when combined with other prompting techniques like Chain-of-Thought or Few-Shot examples.

## Examples

### Basic Persona Prompt
"As a financial advisor with 20 years of experience, explain the concept of dollar-cost averaging to a complete beginner."

### Advanced Persona Prompt
"You are a master chef at a Michelin-starred restaurant specializing in French cuisine. A home cook has asked you to help them elevate their basic omelet recipe. Provide specific techniques, ingredient suggestions, and plating ideas that would transform a simple omelet into a restaurant-quality dish. Consider both flavor combinations and presentation. Include at least one unexpected ingredient that works surprisingly well."

### Multi-Persona Analysis
"I need to understand the implications of implementing a four-day workweek in a medium-sized company. First, respond as a human resources director concerned with employee welfare. Then, respond as a CFO focused on financial impacts. Finally, respond as a productivity consultant looking at operational efficiency."

By mastering the use of personas in your prompts, you can access more specialized knowledge, get more creative responses, and approach problems from multiple perspectives.`;
      }

      // Use the fetch function with more reliable error handling
      fetchContent(url)
        .then(responseText => {
          console.log("Response received successfully!");
          console.log("Raw response:", responseText.substring(0, 200));
          
          // Always treat responses as plain text
          let markdown = responseText;
          
          // Only try to parse as JSON if it looks like JSON and we need to extract specific fields
          if (responseText.trim().startsWith('{') || responseText.trim().startsWith('[')) {
            try {
              const responseJson = JSON.parse(responseText);
              console.log("Response appears to be JSON format");
              
              // Extract markdown content from JSON if available
              if (responseJson.text) {
                console.log("Using 'text' field from JSON");
                markdown = responseJson.text;
              } else if (responseJson.content) {
                console.log("Using 'content' field from JSON");
                markdown = responseJson.content;
              } else if (responseJson.markdown) {
                console.log("Using 'markdown' field from JSON");
                markdown = responseJson.markdown;
              }
              // If no specific fields are found, keep the original text
            } catch (e) {
              console.log("Not valid JSON or JSON parsing error:", e.message);
              // Continue using the raw text
            }
          }

          if (!markdown.includes('#')) {
            markdown = "# " + window.currentTopic.title + "\n\n" + markdown;
          }

          const collapsibleHTML = createCollapsibleBlocks(markdown);
          if (markdownDiv) {
            markdownDiv.innerHTML = collapsibleHTML;
            spinner.classList.add("hidden");
            markdownDiv.classList.remove("hidden");
          }
        })
        .catch(error => {
          console.error("Loading error:", error);
          if (spinner) {
            spinner.classList.add("hidden");
          }
          if (markdownDiv) {
            markdownDiv.classList.remove("hidden");

            // Load emergency content for the Five-step Framework
            if (window.currentTopic && window.currentTopic.title === "Five-step Framework") {
              const fiveStepContent = `# Five-step Framework for Prompt Engineering

The Five-step Framework provides a structured approach to designing effective prompts for AI systems. Each step builds upon the previous one to create prompts that yield accurate, relevant, and useful responses.

## Step 1: Define the Goal

Before writing any prompt, clearly define what you want to achieve.

**Key Questions:**
- What specific output or information do you need?
- What format should the response take?
- Who is the end-user of this information?

**Example:**
Goal: "I need a comprehensive comparison of solar panel types for residential use that helps homeowners make an informed decision."

## Step 2: Provide Context

Give the AI relevant background information to ensure it understands the situation.

**Key Elements:**
- Relevant facts and data
- Audience information
- Domain-specific context
- Any constraints or requirements

**Example:**
"I'm creating content for middle-aged homeowners in sunny Arizona who are considering installing solar panels. They have limited technical knowledge but are environmentally conscious and budget-aware."

## Step 3: Specify Instructions

Clearly state what you want the AI to do and how it should do it.

**Key Components:**
- Task description
- Output format
- Tone and style guidance
- Length requirements

**Example:**
"Create a comparison table of the three most common residential solar panel types (monocrystalline, polycrystalline, and thin-film). Follow the table with 2-3 paragraphs explaining the key differences in layman's terms. Use a friendly but informative tone."

## Step 4: Use Constraints

Set boundaries to prevent unwanted content and guide the AI toward your desired outcome.

**Types of Constraints:**
- Content limitations
- Style restrictions
- Length parameters
- Ethical guardrails

**Example:**
"Avoid technical jargon without explanation. Don't include DIY installation instructions, as these systems require professional installation. Limit the response to 500 words."

## Step 5: Review and Refine

Analyze the AI's response and iterate on your prompt to improve results.

**Review Process:**
1. Evaluate the response against your goal
2. Identify missing or incorrect information
3. Note areas where instructions weren't followed
4. Adjust your prompt accordingly

**Example:**
"The information is good, but there's too much emphasis on cost and not enough on durability. Let me adjust my prompt to prioritize long-term value and performance in extreme weather conditions."

## Putting It All Together

A complete prompt using the Five-step Framework might look like:

"I need a comparison of residential solar panel types (Goal). This is for middle-aged homeowners in Arizona with limited technical knowledge but environmental awareness (Context). Create a table comparing monocrystalline, polycrystalline, and thin-film panels, followed by 2-3 explanatory paragraphs in layman's terms (Instructions). Avoid unexplained jargon and DIY installation details, and prioritize information on durability and performance in hot climates. Limit to 500 words (Constraints)."

By following this framework, you can systematically improve your prompts through each iteration, leading to increasingly accurate and useful AI responses.`;

              markdownDiv.innerHTML = createCollapsibleBlocks(fiveStepContent);
              return;
            }

            // Get detailed error information
            const errorStack = error.stack || '';
            const errorName = error.name || 'Error';
            const errorDetails = JSON.stringify(error, Object.getOwnPropertyNames(error), 2);
            
            markdownDiv.innerHTML = `
              <div style="background-color: #fff0f0; padding: 15px; border-left: 4px solid #ff0000; margin-bottom: 20px;">
                <h3>Ошибка загрузки контента</h3>
                <p>Пожалуйста, обратитесь к руководителю команды.</p>
                <p><strong>Причина:</strong> ${error.message || error.toString()}</p>
                <p><strong>Тип ошибки:</strong> ${errorName}</p>
                <p><strong>URL:</strong> ${url}</p>
                <details>
                  <summary><strong>Технические детали ошибки (для разработчиков)</strong></summary>
                  <pre style="background-color: #f8f8f8; padding: 10px; overflow: auto; max-height: 200px;">${errorDetails}</pre>
                </details>
                <p><small>Это может быть вызвано проблемами с CORS, сетевым подключением или недоступностью сервера.</small></p>
              </div>
            `;
            
            // Add console logging for debugging
            console.error("Detailed error information:", {
              message: error.message,
              name: errorName,
              url: url,
              details: errorDetails
            });
            console.error("Content loading error for URL:", url, error);
            
            // Check if we have a fallback for this content
            if (window.currentTopic) {
              const topicTitle = window.currentTopic.title;
              console.log("Looking for fallback content for:", topicTitle);
              
              // Display fallback content based on topic titles
              if (topicTitle === "Personas in prompting") {
                const personasContent = `# Personas in Prompting

## What are Personas?

Personas in prompt engineering refer to fictional characters or roles that you ask an AI to assume when responding to your prompt. By assigning a specific persona, you can guide the AI to leverage domain-specific knowledge, vocabulary, and reasoning approaches.

## Why Use Personas?

Using personas provides several key benefits:

### Expertise Access
By asking the AI to respond as an expert in a particular field, you can get more specialized information.

### Perspective Shifting
Different personas can provide varied viewpoints on the same question or problem.

### Tone Control
Personas help shape the style, formality, and tone of the AI's response.

### Problem-Solving Approaches
Different personas may use different methodologies to approach a problem.

## Types of Personas

### Expert Personas
These personas represent specialists in specific fields.

**Examples:**
- "As a quantum physicist..."
- "Respond as an experienced pediatrician..."
- "Taking the role of a cybersecurity expert..."

### Character Personas
These include fictional characters, historical figures, or archetypal roles.

**Examples:**
- "Explain this as if you were Sherlock Holmes..."
- "As a medieval blacksmith, describe..."
- "Channel the perspective of Leonardo da Vinci to..."

### Function-Based Personas
These personas focus on a specific task or function rather than expertise.

**Examples:**
- "Act as a summarizer..."
- "As a fact-checker, review..."
- "In the role of a debate moderator..."

## Best Practices

### Be Specific
Define the persona's characteristics clearly. Instead of just "as a scientist," try "as a marine biologist specializing in coral reef ecosystems."

### Provide Context
Give background information that helps the persona understand their role in responding.

### Add Constraints
Specify what the persona should or shouldn't focus on.

### Combine with Other Techniques
Personas work well when combined with other prompting techniques like Chain-of-Thought or Few-Shot examples.

## Examples

### Basic Persona Prompt
"As a financial advisor with 20 years of experience, explain the concept of dollar-cost averaging to a complete beginner."

### Advanced Persona Prompt
"You are a master chef at a Michelin-starred restaurant specializing in French cuisine. A home cook has asked you to help them elevate their basic omelet recipe. Provide specific techniques, ingredient suggestions, and plating ideas that would transform a simple omelet into a restaurant-quality dish. Consider both flavor combinations and presentation. Include at least one unexpected ingredient that works surprisingly well."

### Multi-Persona Analysis
"I need to understand the implications of implementing a four-day workweek in a medium-sized company. First, respond as a human resources director concerned with employee welfare. Then, respond as a CFO focused on financial impacts. Finally, respond as a productivity consultant looking at operational efficiency."

By mastering the use of personas in your prompts, you can access more specialized knowledge, get more creative responses, and approach problems from multiple perspectives.`;
                
                markdownDiv.innerHTML = createCollapsibleBlocks(personasContent);
                spinner.classList.add("hidden");
                markdownDiv.classList.remove("hidden");
                return;
              }
            }
          }

          // Just load some hardcoded text for specific topics
          if (window.currentTopic && window.currentTopic.title === "What prompting is") {
            const defaultContent = `# What prompting is

Prompting is a technique used to communicate with AI language models by providing them with specific instructions or input texts that guide their responses. It's the primary way humans interact with Large Language Models (LLMs) like ChatGPT, Claude, or Gemini.

## Why Prompts Matter

Effective prompts are crucial because they directly influence the quality and relevance of AI responses. The same AI model can generate dramatically different outputs based solely on how a prompt is phrased.

## Key Components of Prompts

### Instructions
Clear directions telling the AI what to do, how to respond, or what format to use.

### Context
Background information that helps the AI understand the topic or situation.

### Examples
Demonstrations of desired outputs that help the AI understand exactly what you want.

### Constraints
Limitations or boundaries that define what the AI should or shouldn't do.

## Different Types of Prompting

### Basic Prompting
Simple questions or statements that request information.
Example: "Explain what photosynthesis is."

### Role-Based Prompting
Asking the AI to assume a specific persona or role.
Example: "As an expert botanist, explain what photosynthesis is."

### Few-Shot Prompting
Providing examples in the prompt to guide the AI's response format.
Example: "Q: What is the capital of France? A: Paris. Q: What is the capital of Japan? A:"

### Chain-of-Thought Prompting
Encouraging the AI to reason step-by-step through a problem.
Example: "Think step by step to solve this math problem: If x + y = 10 and x - y = 4, what are x and y?"

## Prompt Engineering

The practice of designing and refining prompts to get the best possible responses from AI is called prompt engineering. It has become a valuable skill as AI systems become more widespread.

Good prompt engineers understand:
- How different prompting techniques affect AI outputs
- Common pitfalls and how to avoid them
- How to iterate and refine prompts
- How to evaluate AI responses

## The Prompt Engineering Workflow

1. Define your goal clearly
2. Design an initial prompt
3. Evaluate the response
4. Refine the prompt based on the response
5. Repeat until satisfied with the result

The following lessons will explore these concepts in more detail and provide practical exercises to develop your prompt engineering skills.`;

            markdownDiv.innerHTML = createCollapsibleBlocks(defaultContent);
            if (spinner) spinner.classList.add("hidden");
            markdownDiv.classList.remove("hidden");
          } else if (window.currentTopic && window.currentTopic.title === "Prompt Engineering Vocabulary") {
            const vocabularyContent = `# Prompt Engineering Vocabulary

## Core Concepts

### Prompt
A text input given to an AI model that guides its response. This can include questions, instructions, examples, or constraints.

### Large Language Model (LLM)
An AI system trained on vast amounts of text data that can generate human-like text, understand context, and follow instructions.

### Prompt Engineering
The practice of designing and refining prompts to effectively communicate with AI models to get desired outputs.

### Token
The basic unit of text that LLMs process. A token can be a word, part of a word, or a character, depending on the model's tokenization method.

### Context Window
The maximum amount of text (measured in tokens) that an AI model can consider at once, including both the prompt and the generated response.

## Prompting Techniques

### Zero-shot Prompting
Asking an AI to perform a task without providing any examples.
Example: "Translate this sentence to French: 'Hello, how are you?'"

### Few-shot Prompting
Providing the AI with a few examples within the prompt to guide its response format or style.
Example: "English: Hello, French: Bonjour, English: Thank you, French: ?"

### Chain-of-Thought (CoT)
Prompting technique that encourages the AI to show its reasoning process step-by-step.
Example: "Think step by step to solve this math problem."

### Tree of Thoughts
An extension of Chain-of-Thought that explores multiple reasoning paths before arriving at a final answer.

### Role Prompting
Instructing the AI to assume a specific role or persona.
Example: "As an experienced chef, provide feedback on this recipe."

### Retrieval-Augmented Generation (RAG)
Combining an LLM with the ability to retrieve information from an external knowledge base during generation.

## Best Practices

### Specificity
Being clear and detailed in what you're asking the AI to do.

### Structured Format
Organizing prompts with clear sections like "Context," "Instructions," and "Format."

### Constraints
Setting boundaries on what the AI should or shouldn't include in its response.

### Iteration
The process of refining prompts based on the AI's responses to improve results over time.

## Common Challenges

### Prompt Injection
A security concern where malicious instructions are hidden within benign-looking prompts to manipulate the AI's behavior.

### Hallucination
When an AI confidently generates incorrect information that wasn't in its training data.

### Model Alignment
The degree to which an AI's outputs match human values, intentions, and expectations.

### Context Truncation
When a prompt is too long and exceeds the model's context window, causing information loss.`;

            markdownDiv.innerHTML = createCollapsibleBlocks(vocabularyContent);
            if (spinner) spinner.classList.add("hidden");
            markdownDiv.classList.remove("hidden");
          }
        });
    }

    function createCollapsibleBlocks(markdown) {
      markdown = markdown.trim();

      const lines = markdown.split("\n");
      let htmlOutput = "";
      let currentLevel1Title = "";
      let currentLevel1Content = [];
      let inLevel1 = false;

      if (lines.length > 0 && !lines[0].match(/^#\s+/)) {
        lines.unshift("# " + (window.currentTopic ? window.currentTopic.title : "Content"));
      }

      for (let line of lines) {
        let match = line.match(/^#(?!#)\s*(.+)/);
        if (match) {
          if (inLevel1) {
            htmlOutput += renderLevel1Block(currentLevel1Title, currentLevel1Content.join("\n"));
          }
          currentLevel1Title = match[1].trim();
          currentLevel1Content = [];
          inLevel1 = true;
        } else {
          if (inLevel1) {
            currentLevel1Content.push(line);
          }
        }
      }
      if (inLevel1) {
        htmlOutput += renderLevel1Block(currentLevel1Title, currentLevel1Content.join("\n"));
      } else if (!htmlOutput) {
        htmlOutput = marked.parse(markdown);
      }
      return htmlOutput;
    }

    function renderLevel1Block(title, content) {
      const lines = content.split("\n");
      let html = "";
      let subBlocksHtml = "";
      let currentSubTitle = "";
      let currentSubContent = [];
      let hasSubHeader = false;
      let preambleLines = [];

      for (let line of lines) {
        let subMatch = line.match(/^##(?!#)\s*(.+)/);
        if (subMatch) {
          hasSubHeader = true;
          if (currentSubTitle) {
            subBlocksHtml += renderLevel2Block(currentSubTitle, currentSubContent.join("\n"));
            currentSubContent = [];
          }
          currentSubTitle = subMatch[1].trim();
        } else {
          if (hasSubHeader) {
            currentSubContent.push(line);
          } else {
            preambleLines.push(line);
          }
        }
      }
      if (currentSubTitle) {
        subBlocksHtml += renderLevel2Block(currentSubTitle, currentSubContent.join("\n"));
      }
      if (preambleLines.length) {
        html += marked.parse(preambleLines.join("\n"));
      }
      html += subBlocksHtml;
      return `<details>
  <summary>${title}</summary>
  <div>${html}</div>
</details>`;
    }

    function renderLevel2Block(title, content) {
      const lines = content.split("\n");
      let html = "";
      let subBlocksHtml = "";
      let currentSubTitle = "";
      let currentSubContent = [];
      let hasSubHeader = false;
      let preambleLines = [];

      for (let line of lines) {
        let subMatch = line.match(/^###(?!#)\s*(.+)/);
        if (subMatch) {
          hasSubHeader = true;
          if (currentSubTitle) {
            subBlocksHtml += renderLevel3Block(currentSubTitle, currentSubContent.join("\n"));
            currentSubContent = [];
          }
          currentSubTitle = subMatch[1].trim();
        } else {
          if (hasSubHeader) {
            currentSubContent.push(line);
          } else {
            preambleLines.push(line);
          }
        }
      }
      if (currentSubTitle) {
        subBlocksHtml += renderLevel3Block(currentSubTitle, currentSubContent.join("\n"));
      }
      if (preambleLines.length) {
        html += marked.parse(preambleLines.join("\n"));
      }
      html += subBlocksHtml;
      return `<details style="margin-left:20px;">
  <summary>${title}</summary>
  <div>${html}</div>
</details>`;
    }

    function renderLevel3Block(title, content) {
      let parsedContent = marked.parse(content);
      return `<details style="margin-left:40px;">
  <summary>${title}</summary>
  <div>${parsedContent}</div>
</details>`;
    }
  </script>
</body>
</html>